<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <link rel="stylesheet" href="style.css">
    <title>Avalg Grading</title>
  </head>

  <body>

    <!-- </Page header> -->
    <div class="container">
      <div class="jumbotron">
        <h1>DD2440 Grading system</h1>
          <p>
            Given that the first lecture comprised of 40 minutes explaining the
            grading system of the course, I think this can be done more
            efficiently. A quick explonation during lecture and redirecting
            the students to this page might speed up the process for upcoming
            course offerings. It can perhaps also be useful to predict one's
            grade during the course by selecting received, and expected grades so far.
          </p>
          <p>
            Feel free to contribute to the page at
            <a target="_blank"
              rel="noopener noreferrer"
              href="https://github.com/ThonyPrice/AdvancedAlgorithms_course/tree/gh-pages/GradingPage">GitHub
            </a>.
          </p>
      </div>
    </div>
    <!-- </Page header> -->


    <div class="container" onclick="updateGrade()">
      <div class="jumbotron">
      <!-- <Grade box> -->
        <div class="row">
          <h1>
            Expected grade = <span id="calc_grade"></span>
          </h1>
          <font id="reminder" color="red"></font>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <p>
              Click a grade to preview an example of how it can be achived
            </p>
            <button type="button" class="btn btn-primary" onclick="check4grade('A')">A</button>
            <button type="button" class="btn btn-success" onclick="check4grade('B')">B</button>
            <button type="button" class="btn btn-info" onclick="check4grade('C')">C</button>
            <button type="button" class="btn btn-warning" onclick="check4grade('D')">D</button>
            <button type="button" class="btn btn-danger" onclick="check4grade('E')">E</button>
          </div>
        </div>
      <!-- </Grade box> -->
        <br>
      <!-- <Assignments> -->
        <div class="row">
          <div class="col-sm-6">
            <h2>Assignments</h2>
            <p>
              <ul>
                <li>The course include 3 assignments + 1 make up assignment.</li>
                <li>To pass the course you should complete 2 assignments.</li>
                <li>To pass a assignment you must solve 1 question in the assignment.</li>
                <li>The assignments include 5-6 questions graded (A-E).</li>
                <li><h3>Check your grades for the assignments --></h3></li>
              </ul>
            </p>
          </div>
          <div class="col-sm-6">
            <div class="row" style="background-color:#cccccc;">
              <h3 style="padding-left: 15px;">
                <br>
                Assignment 1
              </h3>
              <div class="checkbox">
                <div class="col-sm-2">
                  <label><input id="A-1-A" type="checkbox" value="A-1-A">A</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-1-B" type="checkbox" value="A-1-B">B</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-1-C" type="checkbox" value="A-1-C">C</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-1-D" type="checkbox" value="A-1-D">D</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-1-E" type="checkbox" value="A-1-E" checked>E</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-1-F" type="checkbox" value="A-1-F">F</label>
                </div>
                <br>
              </div>
            </div>
            <div class="row" style="background-color:#e6e6e6;">
              <h3 style="padding-left: 15px;">
                <br>
                Assignment 2
              </h3>
              <div class="checkbox">
                <div class="col-sm-2">
                  <label><input id="A-2-A" type="checkbox" value="A-2-A">A</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-2-B" type="checkbox" value="A-2-B">B</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-2-C" type="checkbox" value="A-2-C">C</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-2-D" type="checkbox" value="A-2-D">D</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-2-E" type="checkbox" value="A-2-E" checked>E</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-2-F" type="checkbox" value="A-2-F">F</label>
                </div>
                <br>
              </div>
            </div>
            <div class="row" style="background-color:#cccccc;">
              <h3 style="padding-left: 15px;">
                <br>
                Assignment 3
              </h3>
              <div class="checkbox">
                <div class="col-sm-2">
                  <label><input id="A-3-A" type="checkbox" value="A-3-A">A</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-3-B" type="checkbox" value="A-3-B">B</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-3-C" type="checkbox" value="A-3-C">C</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-3-D" type="checkbox" value="A-3-D">D</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-3-E" type="checkbox" value="A-3-E">E</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-3-F" type="checkbox" value="A-3-F" checked>F</label>
                </div>
                <br>
              </div>
            </div>
            <div class="row" style="background-color:#e6e6e6;">
              <h3 style="padding-left: 15px;">
                <br>
                Assignment 4 (Optional*)
              </h3>
              <div class="checkbox">
                <div class="col-sm-2">
                  <label><input id="A-4-A" type="checkbox" value="A-4-A">A</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-4-B" type="checkbox" value="A-4-B">B</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-4-C" type="checkbox" value="A-4-C">C</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-4-D" type="checkbox" value="A-4-D">D</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-4-E" type="checkbox" value="A-4-E">E</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="A-4-F" type="checkbox" value="A-4-F" checked>F</label>
                </div>
                <br>
              </div>
            </div>
          </div>
        </div>
      <!-- </Assignments> -->
        <br>
      <!-- <Projects> -->
        <div class="row">
          <div class="col-sm-6">
            <h2>Projects</h2>
            <p>
              <ul>
                <li>The course include 2-3 projects.</li>
                <li>To pass the course you should complete 1 project.</li>
                <li>The projects are performed in groups of 2-4 students.</li>
                <li><h3>Check your grades for the projects --></h3></li>
              </ul>
            </p>
          </div>
          <div class="col-sm-6">
            <div class="row" style="background-color:#cccccc;">
              <h3 style="padding-left: 15px;">
                <br>
                Project 1
              </h3>
              <div class="checkbox">
                <div class="col-sm-2">
                  <label><input id="P-1-A" type="checkbox" value="P-1-A">A</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-1-B" type="checkbox" value="P-1-B">B</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-1-C" type="checkbox" value="P-1-C">C</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-1-D" type="checkbox" value="P-1-D">D</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-1-E" type="checkbox" value="P-1-E" checked>E</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-1-F" type="checkbox" value="P-1-F">F</label>
                </div>
                <br>
              </div>
            </div>
            <div class="row" style="background-color:#e6e6e6;">
              <h3 style="padding-left: 15px;">
                <br>
                Project 2
              </h3>
              <div class="checkbox">
                <div class="col-sm-2">
                  <label><input id="P-2-A" type="checkbox" value="P-2-A">A</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-2-B" type="checkbox" value="P-2-B">B</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-2-C" type="checkbox" value="P-2-C">C</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-2-D" type="checkbox" value="P-2-D">D</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-2-E" type="checkbox" value="P-2-E" checked>E</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-2-F" type="checkbox" value="P-2-F">F</label>
                </div>
                <br>
              </div>
            </div>
            <div class="row" style="background-color:#cccccc;">
              <h3 style="padding-left: 15px;">
                <br>
                Project 3 (Optional*)
              </h3>
              <div class="checkbox">
                <div class="col-sm-2">
                  <label><input id="P-3-A" type="checkbox" value="P-3-A">A</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-3-B" type="checkbox" value="P-3-B">B</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-3-C" type="checkbox" value="P-3-C">C</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-3-D" type="checkbox" value="P-3-D">D</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-3-E" type="checkbox" value="P-3-E">E</label>
                </div>
                <div class="col-sm-2">
                  <label><input id="P-3-F" type="checkbox" value="P-3-F" checked>F</label>
                </div>
                <br>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- </Projects> -->
    </div>

    <!-- <Scripts> -->
    <script>

      // Update grade when user click
      document.onclick = updateGrade();
      document.body.addEventListener('click', updateGrade(), true);
      // Identification of all checkboxes
      // Syntax: "[A(ssignment)|P(roject)]-[Number]-[Grade]"
      var all_boxes_id = [
        "A-1-A", "A-1-B", "A-1-C", "A-1-D", "A-1-E", "A-1-F",
        "A-2-A", "A-2-B", "A-2-C", "A-2-D", "A-2-E", "A-2-F",
        "A-3-A", "A-3-B", "A-3-C", "A-3-D", "A-3-E", "A-3-F",
        "A-4-A", "A-4-B", "A-4-C", "A-4-D", "A-4-E", "A-4-F",
        "P-1-A", "P-1-B", "P-1-C", "P-1-D", "P-1-E", "P-1-F",
        "P-2-A", "P-2-B", "P-2-C", "P-2-D", "P-2-E", "P-2-F",
        "P-3-A", "P-3-B", "P-3-C", "P-3-D", "P-3-E", "P-3-F"
      ]

      function updateGrade() {
        // Collect values of checked boxes
        var checked_values = $('input:checkbox:checked').map(function() {
            return this.value;
        }).get();

        var possible_grades = ["A", "B", "C", "D", "E", "F"];
        var checked_grades = {};
        var performed_tasks = {
          "A" : {"1": 0, "2": 0, "3": 0, "4": 0},
          "P" : {"1": 0, "2": 0, "3": 0}
        };
        // Initialize current_grades dictionary
        for (i=0; i<possible_grades.length; i++) {
          checked_grades[possible_grades[i]] = 0;
        };
        // Transer values of checked data to checked_grades and performed_tasks
        for (i=0; i<checked_values.length; i++) {
          var tokens = checked_values[i].split("-");
          task = tokens[0];
          num = tokens[1];
          grade = tokens[2];
          checked_grades[grade]++;
          if (grade != "F") {
            performed_tasks[task][num] = 1;
          }
        }
        // Update grade from collected data
        var high_grade_counter = 0; // A, A, B -> C i.e. must track higher grades
        var grade_changed = false;
        for (i=0; i<possible_grades.length; i++) {
          if (checked_grades[possible_grades[i]] + high_grade_counter >= 3
              && satisfiedTasks(performed_tasks)) {
            changeGrade(possible_grades[i]);
            grade_changed = true;
            break;
          } else {
            high_grade_counter += checked_grades[possible_grades[i]];
          };
        };
        if (!grade_changed) {
          changeGrade("F");
        }
      }

      function changeGrade(g) {
        document.getElementById('calc_grade').innerHTML = g;
      }

      function satisfiedTasks(tasks) {
        a_score = Object.values(tasks["A"]).reduce((a, b) => a + b, 0);
        p_score = Object.values(tasks["P"]).reduce((a, b) => a + b, 0);
        if (a_score >= 2 && p_score >= 1) {
          document.getElementById("reminder").innerHTML = "";
          return true
        } else {
          document.getElementById("reminder").innerHTML =
            "<h2>Remember! You must complete at least 2 assignments and 1 project.</h2>";
          return false;
        }
      }

      function check4grade(g) {
        uncheckAll();
        d = {
          "A" : ["A-1-A", "A-2-A", "P-1-A"],
          "B" : ["A-1-A", "A-1-B", "P-1-B"],
          "C" : ["A-1-C", "A-4-C", "P-1-B"],
          "D" : ["A-1-D", "A-3-C", "P-1-D"],
          "E" : ["A-1-A", "A-2-D", "P-2-E"]
        }
        boxes_to_check = d[g];
        console.log(boxes_to_check);
        for (var i=0; i<boxes_to_check.length; i++) {
          document.getElementById(boxes_to_check[i]).checked = true;
        }
        updateGrade();
      }

      function uncheckAll() {
        for (var i=0; i<all_boxes_id.length; i++) {
          document.getElementById(all_boxes_id[i]).checked = false;
        }
      }

    </script>
    <!-- </Scripts> -->

  </body>
</html>
